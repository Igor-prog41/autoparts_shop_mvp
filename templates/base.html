{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Shop{% endblock %}</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    >
</head>
<body class="d-flex flex-column min-vh-100">
<header>

          <!-- Top header -->
    <div class="bg-light border-bottom">
       <div class="container-fluid py-2">
           <div class="container">
               <div class="row align-items-center">

                   <!-- Logo -->
                   <div class="col-12 col-md-auto d-flex align-items-center mb-2 mb-md-0">
                       <img src="{% static 'logo.png' %}"
                            alt="MyShop logo"
                            height="44"
                            class="me-2 d-block">
                       <strong class="fs-4">Simple Django Shop</strong></div>

                   <!-- Search -->
                   <div class="col-12 col-md-6 col-lg">
                       <form method="get" action="{% url 'catalog' %}" class="d-flex gap-2">
                           <input type="search"
                                  name="q"
                                  class="form-control"
                                  placeholder="Search parts..."
                                  value="{{ request.GET.q|default:'' }}">

                           <button type="submit" class="btn btn-secondary">
                               Search
                           </button>
                       </form>
                  </div>

                   <!-- Right icons -->
                   <div class="col-12 col-md-auto d-flex justify-content-md-end mt-2 mt-md-0 align-items-center gap-3">

                       {% if request.user.is_authenticated %}
                           <!-- Account -->
                           <a href="{% url 'profile' %}" class="btn btn-outline-secondary btn-sm">
                           {{ request.user.username }}
                           </a>

                           <!-- Logout -->
                           <a href="{% url 'logout' %}" class="btn btn-outline-danger btn-sm">
                                Logout
                           </a>
                       {% else %}
                           <!-- Login -->
                           <a href="{% url 'login' %}" class="btn btn-outline-primary btn-sm">
                                Login
                           </a>
                       {% endif %}

                        <!-- Cart -->
                       <a href="{% url 'cart' %}" class="position-relative text-decoration-none">
                           <img src="{% static 'cart-placeholder-v2.png' %}" alt="Cart" height="44">

                           <!-- Badge -->
                           <span class="position-absolute top-50 start-100 translate-middle badge rounded-pill bg-danger">
                               {{ cart_items_count|default:0 }}
                           </span>
                        </a>
                   </div>

               </div>
           </div>
       </div>
    </div>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <!-- <a class="navbar-brand d-lg-none" href="#">MyShop</a> -->

            <button class="navbar-toggler" type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#navbarNav"
                    aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse justify-content-between" id="navbarNav">
                <ul class="navbar-nav">
                    {% block navbar_items %}
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'catalog' %}">Catalog</a>
                    </li>
                    <li class="nav-item">
                         <a class="nav-link" href="{% url 'about' %}">About</a>
                    </li>
                    {% endblock %}
                </ul>

                            <!-- Right block: dynamic element -->
                {% if show_sort %}
                    <div class="dropdown">
                        <button class="btn btn-outline-light dropdown-toggle"
                                type="button"
                                data-bs-toggle="dropdown" aria-expanded="false">Sort by
                        </button>

                        <form method="get">
                            <ul class="dropdown-menu dropdown-menu-end px-3">
                                <li class="form-check">
                                    <input class="form-check-input"
                                       id="sort_default"
                                       type="radio"
                                       name="sort"
                                       value="default"
                                       onchange="this.form.submit()"
                                       {% if not current_sort or current_sort == "default" %}checked{% endif %}>

                                    <label class="form-check-label" for="sort_default">Default</label>
                                </li>

                                 <li class="form-check">
                                     <input class="form-check-input"
                                        id="sort_price_asc"
                                        type="radio"
                                        name="sort"
                                        value="price_asc"
                                        onchange="this.form.submit()"
                                        {% if current_sort == "price_asc" %}checked{% endif %} >
                                     <label class="form-check-label" for="sort_price_asc">Price ↑</label>
                                 </li>

                                 <li class="form-check">
                                     <input class="form-check-input"
                                        id="sort_price_desc"
                                        type="radio"
                                        name="sort"
                                        value="price_desc"
                                        onchange="this.form.submit()"
                                        {% if current_sort == "price_desc" %}checked{% endif %}>
                                     <label class="form-check-label" for="sort_price_desc">Price ↓</label>
                                 </li>
                            </ul>

                            <!-- Hidden fields for search and tags -->
                            {% for key, value in request.GET.items %}
                                {% if key != 'sort' %}
                                    <input type="hidden" name="{{ key }}" value="{{ value }}">
                                {% endif %}
                            {% endfor %}

                        </form>
                    </div>
                {% endif %}
            </div>
        </div>
    </nav>
</header>

<main class="container my-4">
    {% block content %}
    {% endblock %}
</main>

<footer class="bg-light text-center text-muted py-3 mt-auto">
    <div class="container">
        <small>© 2025 MyShop</small>
    </div>
</footer>

<!-- Bootstrap JS -->
<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js">
</script>
</body>
</html>
